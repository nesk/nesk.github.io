{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/blog/about-circular-references-in-php/",
    "result": {"data":{"mdx":{"frontmatter":{"title":"About circular references in PHP","date":"2018-02-01","formattedDate":"1st February 2018","featuredImage":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABj0lEQVQoz2Pwj55MDAqIwSLI4BMx0TdyUkDMFKwafCImeoVP8ImY6BM5EVMNQ1LOvIjkmd7hE3yjJqHrjJwYnjz90PGbp87eC0uc7hnaj6afoaByeW3bhpK6VSEJ03wjJyFpnuITMTGnbOnk2XuXrjlx596r+vYNXuETkPUzTJ2zb/bCQ71Td1W3rA2MRTF476Hr9x68dvLvaevd+v///5rW9c7+3chqGM5efLhm45n2/q1ZJUvSCxd6hSHMPnfxwbmLDxNy5nmGTYjNmN0zZUd02iyfiIkBcM0bt50vql6RVriwoXNjYMwUv6jJgbFTXAJ7mro3X7n+1D2kLzRheu+Unb6Rk46cvD1lzj7ngB645QwldatK61ZVNa8NTZwO8XNAzBSvsAkp+Qtu33u5cv2pvmm7/v//f/HK46s3nhZWr0AONoak3PnRabNAoY0SWpO9wyeGJ82IyZgdnzV31YbTOWVLwxKne4dPRI5wBu+IiT4RWOI5IGayb+QkUAxHTPQKmwA2fSJ6PBOZwrAiAHXuNriiMAyAAAAAAElFTkSuQmCC","width":1200,"height":630,"src":"/static/54128850cfef0f0c28056c653878a7a0/b576f/featured.png","srcSet":"/static/54128850cfef0f0c28056c653878a7a0/b576f/featured.png 1x,\n/static/54128850cfef0f0c28056c653878a7a0/59c78/featured.png 1.5x"},"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABd0lEQVQY01WRW0sCURCA/W/1kLmuq7Tu2UviNTLWCq+lqT2ID6Ho2V3RFbSoVs2VjCIyIXywSLEwSiF6qf5J6JFQmKeZ+WaGbzQGVkShpwUUOCMQnPifN7AiwYk6Ci4TKQO7UNIQnKinIQYgacsbLTmzLW+y5HRUdp7UmjN2vpzO3esAXKWyBCfNYAxAxlX0x+q74dqRcOc7uPDH6nxIIVgRZ4QpLBGcFE1etTuj7vMXu1HEaIj2ayhHwbNXSUmtenPQ7owVtde4fklJLbfvDGcE47q0RKTanfFt+93Aiq9vP3bPsZbMoOUa2iXvhKsn1afSeTeSuKyoPUXteSO17f0KEkE75c7jZyBeBw7ZulWqNvrG+bNtfDmRvuGDit1TDh2qgbjKhxTSmseZiT/KUWg9jKLJ5vDjdzD8rjT6C8IwAHFGAE7Z4i7RTpm0zTDUgQFomooMxtVN76kOZJGLCYx8ogsxANG3Fv7EivrJLLiyltGas/OlPw+55FdXKq3/AAAAAElFTkSuQmCC","aspectRatio":2.6666666666666665,"src":"/static/54128850cfef0f0c28056c653878a7a0/7fb2b/featured.png","srcSet":"/static/54128850cfef0f0c28056c653878a7a0/cb016/featured.png 640w,\n/static/54128850cfef0f0c28056c653878a7a0/7952d/featured.png 1280w,\n/static/54128850cfef0f0c28056c653878a7a0/7fb2b/featured.png 2000w","srcWebp":"/static/54128850cfef0f0c28056c653878a7a0/fbe34/featured.webp","srcSetWebp":"/static/54128850cfef0f0c28056c653878a7a0/2420f/featured.webp 640w,\n/static/54128850cfef0f0c28056c653878a7a0/99b9e/featured.webp 1280w,\n/static/54128850cfef0f0c28056c653878a7a0/fbe34/featured.webp 2000w","sizes":"(max-width: 2000px) 100vw, 2000px"}}}},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"About circular references in PHP\",\n  \"date\": \"2018-02-01\",\n  \"slug\": \"about-circular-references-in-php\",\n  \"featuredImage\": \"images/featured.png\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Caption = makeShortcode(\"Caption\");\nvar Note = makeShortcode(\"Note\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Let me talk about some issues I encountered with circular references while working on my \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/nesk/puphpeteer\"\n  }, \"PuPHPeteer\"), \" library.\"), mdx(\"h1\", null, \"How you can end up with circular references\"), mdx(\"p\", null, \"Under the hood, PuPHPeteer uses \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/nesk/rialto\"\n  }, \"Rialto\"), \", a library I've created for the occasion. Rialto is a library to manage Node resources, therefore it needs to create a Node process and communicate with it. To do so, it has a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ProcessSupervisor\"), \" class which handles everything. In the early stage development, this class was handling way too much features.\"), mdx(\"p\", null, \"To improve \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://en.wikipedia.org/wiki/Separation_of_concerns\"\n  }, \"the separation of concerns\"), \", I've moved all the functions handling data serialization to two new classes: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DataSerializer\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DataUnserializer\"), \". That way, the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ProcessSupervisor\"), \" class only had to instanciate these two classes and use their public methods.\"), mdx(\"p\", null, \"However, the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DataUnserializer\"), \" class needed to keep a reference to its \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ProcessSupervisor\"), \" parent (so it can transmit the reference to some classes it creates on unserialization). We had this code organization:\"), mdx(Caption, {\n    text: \"If anyone told me I would need a UML diagram one day, I would have not believed him.\",\n    mdxType: \"Caption\"\n  }, mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"850px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/995e6193861bfdf705d80067b159df11/33c03/uml-1.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"61.502347417840376%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABPUlEQVQoz42SbW+CMBRG+f8/bfBBYkbaWCPiSywlLThKb28vZYk451zcPF9vTvs8t02mnxBR3/d4IYQAznnvpyckv2WtNeecMfZeFLKuASDG+JIcQtBap2maZdlbmimlAODVm8dxBAAiats2hOC9DyG8Kt8Sns/n6T8eZdN2Xdft9/uVEPvDoes6ay0R/SUTkXPOGMMYq6pdURTL5XKxWEgph2HAJwu/ytbacRynaaqqHedciLUQgnO+2WxWQhyPR+993/cPKa6yc25ui4geoG1bpRoAsNbOo3nqnEPE22oSIkJEpdT8N76PuIv60fcAoOparNebshyGAQAQMQGA3a7K85wzppS6vba1Fi4458rttiy3jLGiKPI8FytxOp2stUmMcW4bY7zvE75AxNYYKaU2RmvTNE0tpdaaiD4B3VC1TV90q1kAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"picture\", {\n    parentName: \"a\"\n  }, \"\\n          \", mdx(\"source\", {\n    parentName: \"picture\",\n    \"srcSet\": [\"/static/995e6193861bfdf705d80067b159df11/558a3/uml-1.webp 213w\", \"/static/995e6193861bfdf705d80067b159df11/71a10/uml-1.webp 425w\", \"/static/995e6193861bfdf705d80067b159df11/4177e/uml-1.webp 850w\", \"/static/995e6193861bfdf705d80067b159df11/5ad0e/uml-1.webp 1140w\"],\n    \"sizes\": \"(max-width: 850px) 100vw, 850px\",\n    \"type\": \"image/webp\"\n  }), \"\\n          \", mdx(\"source\", {\n    parentName: \"picture\",\n    \"srcSet\": [\"/static/995e6193861bfdf705d80067b159df11/dd148/uml-1.png 213w\", \"/static/995e6193861bfdf705d80067b159df11/1b6ed/uml-1.png 425w\", \"/static/995e6193861bfdf705d80067b159df11/7fd2c/uml-1.png 850w\", \"/static/995e6193861bfdf705d80067b159df11/33c03/uml-1.png 1140w\"],\n    \"sizes\": \"(max-width: 850px) 100vw, 850px\",\n    \"type\": \"image/png\"\n  }), \"\\n          \", mdx(\"img\", {\n    parentName: \"picture\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/995e6193861bfdf705d80067b159df11/7fd2c/uml-1.png\",\n    \"alt\": \"A UML diagram showing how ProcessSupervisor and DataUnserializer classes create a circular reference\",\n    \"title\": \"A UML diagram showing how ProcessSupervisor and DataUnserializer classes create a circular reference\",\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  }), \"\\n        \"), \"\\n  \"), \"\\n    \"))), mdx(\"p\", null, \"And this is where we have an issue: if the root object is destroyed, the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ProcessSupervisor\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DataUnserializer\"), \" instances will stay alive because they reference each other.\"), mdx(\"h1\", null, \"How circular references can be\\xA0harmful\"), mdx(\"p\", null, \"Some languages can handle them pretty well, but since PHP's garbage collector is using \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.php.net/manual/en/features.gc.refcounting-basics.php\"\n  }, \"reference\"), \" \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://en.wikipedia.org/wiki/Garbage_collection_(computer_science)#Reference_counting\"\n  }, \"counting\"), \", the two instances will be destroyed only once PHP shuts down:\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"Fortunately, PHP will clean up this data structure at the end of the request, but before then, this is taking up valuable space in memory.\"), mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u2013 \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.php.net/manual/en/features.gc.refcounting-basics.php#features.gc.cleanup-problems\"\n  }, \"php.net\"))), mdx(\"p\", null, \"However, memory isn't the only issue here. Let me take another example with Rialto: the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ProcessSupervisor\"), \" uses the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"__destruct\"), \" method to kill the Node process once the class is no longer used, and here's what the PHP documentation states:\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"The destructor method will be called as soon as there are no other references to a particular object, or in any order during the shutdown sequence.\"), mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u2013 \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.php.net/manual/en/language.oop5.decon.php#language.oop5.decon.destructor\"\n  }, \"php.net\"))), mdx(\"p\", null, \"This means the Node process will be kept alive until PHP shuts down because there will still exist a reference to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ProcessSupervisor\"), \" instance.\"), mdx(\"p\", null, \"So, having a circular dependency in PHP can be harmful for two reasons:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Memory allocation\"), \": if your instances store large chunks of data (arrays with thousands of very long strings, etc\\u2026).\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Destruction\"), \": if your instances needs to do some cleanup on destruction, the cleanup will only happen on PHP shutdown.\")), mdx(\"p\", null, \"Ultimately, these issues will bother you essentially with long running processes, but even with simple web requests there could some side effects if your classes allocates a high volume of memory or needs to do proper cleaning at the right time.\"), mdx(\"h1\", null, \"How you can solve circular references\"), mdx(\"p\", null, \"You have three ways to solve your circular references issues:\"), mdx(\"h2\", null, \"Use weak references\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"A \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"weak reference\"), \" is a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://en.wikipedia.org/wiki/Reference_(computer_science)\"\n  }, \"reference\"), \" that does not protect the referenced \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://en.wikipedia.org/wiki/Object_(computer_science)\"\n  }, \"object\"), \" from collection by a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://en.wikipedia.org/wiki/Garbage_collection_(computer_science)\"\n  }, \"garbage collector\"), \".\"), mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u2013 \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://en.wikipedia.org/wiki/Weak_reference\"\n  }, \"Wikipedia\"))), mdx(\"p\", null, \"Weak references is a missing language feature in PHP. You will need to use an extension. You can use either \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/colder/php-weakref\"\n  }, \"WeakRef\"), \" or \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/pinepain/php-ref\"\n  }, \"PHP Ref\"), \", I will use the first one below.\"), mdx(\"p\", null, \"Since this solution requires a PHP extension, it's not the best choice if you're writing a library or a command line, but if you're creating a website you will manage by yourself then it's probably what you should use.\"), mdx(\"p\", null, \"Here's a code example:\"), mdx(\"pre\", {\n    \"className\": \"grvsc-container one-dark-pro\",\n    \"data-language\": \"php\",\n    \"data-index\": \"0\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"grvsc-code\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"class\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"ParentClass\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"{\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"public\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"function\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"__construct\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"()\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    {\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"        \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"$this\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"->\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"child\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"=\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"new\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"ChildClass\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"$this\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \");\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    }\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"}\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  })), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"class\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"ChildClass\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"{\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"public\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"function\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"__construct\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"ParentClass\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"$parent\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \")\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    {\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"        \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"$this\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"->\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"parent\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"=\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"new\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"WeakRef\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"$parent\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \");\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    }\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"}\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  })), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"$instance\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"=\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"new\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"ParentClass\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \";\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  })), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk5 mtki\"\n  }, \"// Do your work...\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  })), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk5 mtki\"\n  }, \"// Once the parent instance is unreferenced, the parent and child instances will be destroyed.\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"unset\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"$instance\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \");\"))))), mdx(\"h2\", null, \"Create a dereferencing method\"), mdx(\"p\", null, \"If you cannot install a PHP extension (because of a shared hosting, or whatever\\u2026), you can create a method to cleanup your circular references.\"), mdx(\"p\", null, \"However, this solution requires to call explicitly the dereferencing method, otherwise your circular reference will remain until PHP shuts down.\"), mdx(\"p\", null, \"Since you're required to call a method, this might not be the best idea for a library. Here's an example of the implementation:\"), mdx(\"pre\", {\n    \"className\": \"grvsc-container one-dark-pro\",\n    \"data-language\": \"php\",\n    \"data-index\": \"1\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"grvsc-code\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"class\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"ParentClass\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"{\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"public\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"function\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"__construct\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"()\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    {\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"        \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"$this\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"->\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"child\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"=\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"new\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"ChildClass\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"$this\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \");\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    }\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  })), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"public\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"function\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk3\"\n  }, \"destroy\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"()\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    {\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"        \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"$this\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"->\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"child\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"->\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk3\"\n  }, \"destroy\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"();\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    }\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"}\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  })), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"class\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"ChildClass\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"{\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"public\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"function\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"__construct\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"ParentClass\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"$parent\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \")\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    {\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"        \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"$this\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"->\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"parent\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"=\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"$parent\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \";\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    }\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  })), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"public\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"function\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk3\"\n  }, \"destroy\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"()\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    {\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"        \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk5 mtki\"\n  }, \"// By setting the parent property to null, you remove the circular reference.\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"        \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"$this\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"->\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"parent\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"=\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk7\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \";\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    }\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"}\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  })), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"$instance\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"=\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"new\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk11\"\n  }, \"ParentClass\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \";\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  })), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk5 mtki\"\n  }, \"// Do your work...\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  })), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk5 mtki\"\n  }, \"// Before unreferencing the parent, call the destroy method.\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"$instance\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"->\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk3\"\n  }, \"destroy\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"();\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  })), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk5 mtki\"\n  }, \"// Unreference the parent\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"unset\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"$instance\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \");\"))))), mdx(\"h2\", null, \"Change your code structure\"), mdx(\"p\", null, \"If you don't want to add a derefencing method because you're creating a library and you want to keep the API really simple, you might want to change your code structure.\"), mdx(\"p\", null, \"This is what I did with Rialto. I didn't want to put back the unserializing methods in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ProcessSupervisor\"), \" class, so I went with a different solution and replaced the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DataUnserializer\"), \" class by a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"UnserializesData\"), \" trait which is imported in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ProcessSupervisor\"), \" class. Here's the new code organization:\"), mdx(Caption, {\n    text: \"Probably the last UML diagram I will ever create\\u2026\",\n    mdxType: \"Caption\"\n  }, mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"764px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/66a14426760c36088d20b81008bc1052/cac7a/uml-2.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"84.50704225352112%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiklEQVQ4y42SW3ObMBCF/f//Vdw3h9pYpg8Upx6GWOgKCCRukladCZNMg9Mh502a82nP7moXPgsArLUA4Jzz71ouvfcr82511lpXVYUxFkISQigllDJCaV3XbdtuwF3XOeey7Ho4HPb7/fF4fHr6cYrj2c5d123AbdsCAKX08Pyc/EoQQlF0vN8xAGxX7vteKSWlpJRhjIuiYIwLIZRSxpgNOIRgrXXOLS3IqgohOOestY/OL+B/X3mMugFP01TXtda6LMs8z40xSqlhGDZgAAghKKVutxtCl/PphBBKkuTl5Y9S6sOwXZkQ0jRNXdeMUsbYOI7f7VlrvcwshOC911p/t+eyxISQJeSSk3Oe5/k2DABF8ao/r3Sepvvr/SPLf2EhxJch53kmhKwHNk1T0zScc8E5pTTLsqqqViYAaJomTVNCqRCCMSalHMdxp7XmjF0ul3N8jqIoTX9LKVf/yXuPMc6yLI5jdEZR9PN6vXZdt3POaa37Nw3DYN70GHvoe2NM/+4zxlhr/wI1IdhVbTVSgwAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"picture\", {\n    parentName: \"a\"\n  }, \"\\n          \", mdx(\"source\", {\n    parentName: \"picture\",\n    \"srcSet\": [\"/static/66a14426760c36088d20b81008bc1052/558a3/uml-2.webp 213w\", \"/static/66a14426760c36088d20b81008bc1052/71a10/uml-2.webp 425w\", \"/static/66a14426760c36088d20b81008bc1052/bfc69/uml-2.webp 764w\"],\n    \"sizes\": \"(max-width: 764px) 100vw, 764px\",\n    \"type\": \"image/webp\"\n  }), \"\\n          \", mdx(\"source\", {\n    parentName: \"picture\",\n    \"srcSet\": [\"/static/66a14426760c36088d20b81008bc1052/dd148/uml-2.png 213w\", \"/static/66a14426760c36088d20b81008bc1052/1b6ed/uml-2.png 425w\", \"/static/66a14426760c36088d20b81008bc1052/cac7a/uml-2.png 764w\"],\n    \"sizes\": \"(max-width: 764px) 100vw, 764px\",\n    \"type\": \"image/png\"\n  }), \"\\n          \", mdx(\"img\", {\n    parentName: \"picture\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/66a14426760c36088d20b81008bc1052/cac7a/uml-2.png\",\n    \"alt\": \"A UML diagram showing how the circular reference can be broken using traits\",\n    \"title\": \"A UML diagram showing how the circular reference can be broken using traits\",\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  }), \"\\n        \"), \"\\n  \"), \"\\n    \"))), mdx(\"p\", null, \"However, this is not always possible! I was able to do it here because Rialto used only one instance of the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DataUnserializer\"), \" class. If I had used multiple instances of this class (for\\u2026 reasons), I could not have done that.\"), mdx(\"h1\", null, \"This could be way\\xA0better\"), mdx(\"p\", null, \"PHP is a real mess when it comes to manage circular references. \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://wiki.php.net/rfc/weakreferences\"\n  }, \"A RFC was proposed\"), \" to add a SplWeakRef class to the standard PHP library, but it is marked as inactive\\u2026\"), mdx(Note, {\n    mdxType: \"Note\"\n  }, mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.php.net/releases/7_4_0.php\"\n  }, \"Weak references were added to PHP 7.4!\"))), mdx(\"p\", null, \"In the other hand, not having weak references wouldn't be an issue if PHP's garbage collector used \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://en.wikipedia.org/wiki/Garbage_collection_(computer_science)#Tracing\"\n  }, \"the tracing algorithm\"), \", but instead we have that crappy reference counting\\u2026\"), mdx(\"p\", null, \"If you encounter circular references in your code, two words: good luck!\"), mdx(\"style\", {\n    \"className\": \"grvsc-styles\"\n  }, \"\\n  \\n  .one-dark-pro {\\n    background-color: #282c34;\\n    color: #abb2bf;\\n  }\\n  .one-dark-pro .mtki { font-style: italic; }\\n  .one-dark-pro .mtk9 { color: #C678DD; }\\n  .one-dark-pro .mtk1 { color: #ABB2BF; }\\n  .one-dark-pro .mtk11 { color: #E5C07B; }\\n  .one-dark-pro .mtk8 { color: #56B6C2; }\\n  .one-dark-pro .mtk4 { color: #E06C75; }\\n  .one-dark-pro .mtk5 { color: #7F848E; }\\n  .one-dark-pro .mtk3 { color: #61AFEF; }\\n  .one-dark-pro .mtk7 { color: #D19A66; }\\n  .one-dark-pro .grvsc-line-highlighted::before {\\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\\n  }\\n\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"slug":"about-circular-references-in-php","cropFocus":"ATTENTION","quality":80}},
    "staticQueryHashes": ["1092343521"]}