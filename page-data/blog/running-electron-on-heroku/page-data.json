{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/blog/running-electron-on-heroku/",
    "result": {"data":{"mdx":{"frontmatter":{"title":"Running Electron on Heroku","date":"2017-03-06","formattedDate":"6th March 2017","featuredImage":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABsElEQVQoz31Syy5DURTd585E0kQYeEdCIgiRBgO099GjqYqKIghN1CNe8WiQtkJU4hP0ntMoGi1aWlpcXDE0YGBu7kekp9KHIFmT81h77b32AgPQNHiQ9eDNRvZrDhDFnA/SBxHIYPHJTNPlVENkuvHCXh8ZqwqJQAzoF7KEaCfsf5MxI+8OqGvSzUpHfL4l5rGqW5bH/sKAADJmOphVwZD82Z1/MFwahHSxLs632H61N/68v/TiNCquHmWq6WK0MqQHL0ZUB14e5BTTnOef00YnasMZMuZ8K7r4jlV9f/pUAx8b+HZWGx0pD/Igi0AW22Ij5UERiAjEojlaaI1N1kcyZAmou1vpKziWgHgG1cPNt8mGyGhFiAdZANllUmw15zwbQQCyLt3OaaNZyog6+ISDT9iqzzZ77v3uV3tdmLUtGxCVOCoiglFyI0MlJ1uWh7Gq0xzlbcuDrfrMWhSw14WX269XdYnhsmBKLekWM0wE0qs5cugTZo0/47YA8mzzpdt87zTeOY13LpOy3BGXgPyyJ6CpCED2rR68AptQYCb9ExLM+X6ScW4eMKJ/JozhC8vg3X6uCq9cAAAAAElFTkSuQmCC","width":1200,"height":630,"src":"/static/a429715c408f505b7e3454e1028e777a/b576f/featured.png","srcSet":"/static/a429715c408f505b7e3454e1028e777a/b576f/featured.png 1x,\n/static/a429715c408f505b7e3454e1028e777a/59c78/featured.png 1.5x"},"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABcklEQVQY02NwZpgBQY5M0z05ZntyzPZgm+3INB0uDkWMMxwZpruxzHJiAjGcGUGCDHCJRM0VWaZrk3VW5dtsSFBf4cgw3YVxhgsjTDPzDFeWmTFKS3Mt17uzznJmgmtmACnKNFnblbCvJXJPgd3GTJO1LowznRim2zNMc2aY4cQwPUxqUbLOyni15RlGa9IN14SIL3RimA7TzDQzTX91rd/2tRMu1QfuTNZZ6cwww5Njdo7FejfmmQ4M0xI0VsSrL4+QWxwstTBRY2WU/FJHuGZnhhnZFutCJBclGa2cmH04WXeVC+MMV6aZ4dKLXZhAmnMt1qcbrg6XXhQivihVb3W49GKEZieGGbmW69P0V6forixx2pRpshYiDnd2nNrySLklaQarM4zWZJutgwQKIsCCxRak6q1K0lqZrL0qSHQBNEhhAQYyhXFGhOySCNklLiwzIYYinO3AMN2OYao9CE0D6USNKhfGmWA10xxA2qZDuABe5qDSW45ciQAAAABJRU5ErkJggg==","aspectRatio":2.6666666666666665,"src":"/static/a429715c408f505b7e3454e1028e777a/0b948/featured.png","srcSet":"/static/a429715c408f505b7e3454e1028e777a/cb016/featured.png 640w,\n/static/a429715c408f505b7e3454e1028e777a/7952d/featured.png 1280w,\n/static/a429715c408f505b7e3454e1028e777a/0b948/featured.png 2048w","srcWebp":"/static/a429715c408f505b7e3454e1028e777a/8120f/featured.webp","srcSetWebp":"/static/a429715c408f505b7e3454e1028e777a/2420f/featured.webp 640w,\n/static/a429715c408f505b7e3454e1028e777a/99b9e/featured.webp 1280w,\n/static/a429715c408f505b7e3454e1028e777a/8120f/featured.webp 2048w","sizes":"(max-width: 2048px) 100vw, 2048px"}}}},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Running Electron on Heroku\",\n  \"date\": \"2017-03-06\",\n  \"slug\": \"running-electron-on-heroku\",\n  \"featuredImage\": \"images/featured.png\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Warning = makeShortcode(\"Warning\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(Warning, {\n    mdxType: \"Warning\"\n  }, mdx(\"p\", null, \"This article was written when only \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://devcenter.heroku.com/articles/cedar-14-stack\"\n  }, \"the \", mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Cedar-14\"), \" stack\"), \" was available. I didn't try to run Electron on \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://devcenter.heroku.com/articles/heroku-16-stack\"\n  }, \"the new \", mdx(\"em\", {\n    parentName: \"a\"\n  }, \"Heroku-16\"), \" stack\"), \".\")), mdx(\"p\", null, \"These last days I've developed a module to scrap some data with \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://www.nightmarejs.org/\"\n  }, \"Nightmare\"), \", a headless browser based on \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://electron.atom.io/\"\n  }, \"Electron\"), \". Once my code was finished I tried to run it on \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.heroku.com/home\"\n  }, \"Heroku's infrastructure\"), \" and was pretty disappointed to see it wasn't running though it worked perfectly on my local machine.\"), mdx(\"p\", null, \"After a bit of research, I've found that \\u201C\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/electron/electron/blob/e315116/docs/tutorial/testing-on-headless-ci.md\"\n  }, \"Electron requires a display driver to function\"), \"\\u201D. Of course, Heroku doesn't provide any display driver since there is nearly no incentive to that. Thankfully, the Electron team addressed this issue (on the same documentation page) and recommends to use \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.x.org/archive/X11R7.6/doc/man/man1/Xvfb.1.xhtml\"\n  }, \"Xvfb\"), \", a tool which allows to run a virtual display server on your machine.\"), mdx(\"h1\", null, \"Installing Xvfb\"), mdx(\"p\", null, \"You will need to add the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/heroku/heroku-buildpack-apt\"\n  }, \"APT buildpack\"), \" to your app, which allows to install APT packages \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://devcenter.heroku.com/articles/slug-compiler\"\n  }, \"at compile time\"), \":\"), mdx(\"pre\", {\n    \"className\": \"grvsc-container one-dark-pro\",\n    \"data-language\": \"sh\",\n    \"data-index\": \"0\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"grvsc-code\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"heroku buildpacks:add -i 1 https://github.com/heroku/heroku-buildpack-apt\"))))), mdx(\"p\", null, \"Then add a file named \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Aptfile\"), \" in the root directory of your app with the following contents, each line contains the name of a package we want to install:\"), mdx(\"pre\", {\n    \"className\": \"grvsc-container one-dark-pro\",\n    \"data-language\": \"sh\",\n    \"data-index\": \"1\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"grvsc-code\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"libxss1\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"xvfb\"))))), mdx(\"p\", null, \"The next time you will deploy your application, Xvfb will be installed on your dynos, however the command will not work right out of the box because of the architecture of Heroku's servers. You will need to install the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/captain401/heroku-buildpack-xvfb\"\n  }, \"Xvfb buildpack\"), \" written by \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/yoz\"\n  }, \"yoz\"), \", which patches the Xvfb command so it can run properly. Obviously, this buildpack should run \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"after\"), \" the APT one:\"), mdx(\"pre\", {\n    \"className\": \"grvsc-container one-dark-pro\",\n    \"data-language\": \"sh\",\n    \"data-index\": \"2\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"grvsc-code\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"heroku buildpacks:add -i 2 https://github.com/captain401/heroku-buildpack-xvfb\"))))), mdx(\"h1\", null, \"Running the virtual display server\"), mdx(\"p\", null, \"Now you need to run Xvfb before launching your Electron process. Instead of starting a new instance of Xvfb each time you want to run Electron, you could launch Xvfb at startup. Heroku provides the ability to run a bash script on startup \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://devcenter.heroku.com/articles/dynos#the-profile-file\"\n  }, \"through a \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \".profile\"), \" file\"), \" located at the root directory of your app. Here is what it should contain:\"), mdx(\"pre\", {\n    \"className\": \"grvsc-container one-dark-pro\",\n    \"data-language\": \"sh\",\n    \"data-index\": \"3\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"grvsc-code\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"export\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" DISPLAY=\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk6\"\n  }, \"':99.0'\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"Xvfb :99 -screen 0 1024x768x24 > /dev/null 2>&1 &\"))))), mdx(\"p\", null, \"These two lines are copied from \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/electron/electron/blob/e315116/docs/tutorial/testing-on-headless-ci.md#travis-ci\"\n  }, \"the configuration the Electron team provides for Travis CI\"), \". The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$DISPLAY\"), \" variable identifies your Xvfb instance and will be read by Electron, according to the documentation:\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"Chromium in Electron will automatically look for \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$DISPLAY\"), \", so no further configuration of your app is required.\")), mdx(\"p\", null, \"In the second line we run the Xvfb server in background and define the screen properties.\"), mdx(\"p\", null, \"One last thing, maybe you want to run the virtual display server only on one type of dyno. Heroku provides \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://devcenter.heroku.com/articles/dynos#local-environment-variables\"\n  }, \"a \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"$DYNO\"), \" variable\"), \" containing the process type and an identifier. So if you want to run Xvfb only for the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"scraper\"), \" process type, you will need to write the following code in your \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".profile\"), \" file:\"), mdx(\"pre\", {\n    \"className\": \"grvsc-container one-dark-pro\",\n    \"data-language\": \"sh\",\n    \"data-index\": \"4\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"grvsc-code\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"if\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" [ \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"-z\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk6\"\n  }, \"\\\"\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"$DYNO\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk6\"\n  }, \"\\\"\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" ] || [[ \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk4\"\n  }, \"$DYNO\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk8\"\n  }, \"==\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" *\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk6\"\n  }, \"\\\"scraper\\\"\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"* ]]; \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"then\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    \"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"export\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \" DISPLAY=\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk6\"\n  }, \"':99.0'\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk1\"\n  }, \"    Xvfb :99 -screen 0 1024x768x24 > /dev/null 2>&1 &\"))), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"grvsc-line\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"grvsc-source\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"mtk9\"\n  }, \"fi\"))))), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[ -z \\\"$DYNO\\\"]\"), \" part checks if the variable is unset or empty. I prefer to add this since Heroku states in its documentation:\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$DYNO\"), \" variable is experimental and subject to change or removal.\")), mdx(\"p\", null, \"Thus, if the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$DYNO\"), \" variable gets removed, your virtual display server will still be running, but on all your dynos instead on the type you defined.\"), mdx(\"h1\", null, \"It might be simpler in the future\"), mdx(\"p\", null, \"Since December, Chromium supports \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://bugs.chromium.org/p/chromium/issues/detail?id=546953#c148\"\n  }, \"the \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"--headless\"), \" command line flag\"), \" which allows to run it without any display server. I don't know if Electron will integrate this feature in the future, but this could be great for saving time for developers.\"), mdx(\"style\", {\n    \"className\": \"grvsc-styles\"\n  }, \"\\n  \\n  .one-dark-pro {\\n    background-color: #282c34;\\n    color: #abb2bf;\\n  }\\n  .one-dark-pro .mtk1 { color: #ABB2BF; }\\n  .one-dark-pro .mtk9 { color: #C678DD; }\\n  .one-dark-pro .mtk6 { color: #98C379; }\\n  .one-dark-pro .mtk8 { color: #56B6C2; }\\n  .one-dark-pro .mtk4 { color: #E06C75; }\\n  .one-dark-pro .grvsc-line-highlighted::before {\\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\\n  }\\n\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"slug":"running-electron-on-heroku","cropFocus":"ATTENTION","quality":80}},
    "staticQueryHashes": ["1092343521"]}